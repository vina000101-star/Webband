<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JASA TEBAR | ULTRA-WIDE PANEL</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00d4ff; --secondary: #0055ff;
            --bg-dark: #06090f; --card-bg: #11161d;
            --border: #212833; --text-main: #ffffff; --text-dim: #94a3b8;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--bg-dark); color: var(--text-main); display: flex; height: 100vh; width: 100vw; overflow: hidden; }

        /* SIDEBAR SISTEM */
        aside {
            width: 260px; background: var(--card-bg); border-right: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 25px 15px; flex-shrink: 0;
            transition: all 0.3s ease; z-index: 1000;
        }
        aside.hidden { margin-left: -260px; }

        .nav-link {
            display: flex; align-items: center; gap: 12px; padding: 14px 18px; border-radius: 12px;
            color: var(--text-dim); text-decoration: none; margin-bottom: 8px; transition: 0.3s; font-weight: 600; cursor: pointer;
        }
        .nav-link.active { background: rgba(0, 212, 255, 0.1); color: var(--primary); }

        /* TOGGLE FLOATING BUTTON */
        .toggle-menu {
            position: fixed; left: 15px; top: 15px; z-index: 1100;
            width: 40px; height: 40px; background: var(--card-bg); border: 1px solid var(--border);
            border-radius: 10px; color: var(--primary); display: flex; align-items: center; justify-content: center;
            cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        /* MAIN CONTENT AREA - FULL SCREEN READY */
        main { flex-grow: 1; overflow-y: auto; background: #06090f; display: flex; flex-direction: column; }
        
        .container-fluid {
            width: 100%;
            max-width: 1400px; /* Diperlebar signifikan */
            margin: 0 auto;
            padding: 70px 30px 40px 30px;
        }

        .page { display: none; }
        .page.active { display: block; }

        /* CARD FULL WIDTH */
        .card-full {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 35px;
            margin-bottom: 25px;
            width: 100%;
        }

        .section-title { font-size: 0.8rem; font-weight: 800; color: var(--primary); letter-spacing: 1px; margin-bottom: 20px; text-transform: uppercase; }

        /* INPUT AREA */
        .upload-wide {
            border: 2px dashed var(--border); border-radius: 20px; padding: 40px;
            text-align: center; cursor: pointer; background: rgba(255,255,255,0.01); transition: 0.3s;
        }
        .upload-wide:hover { border-color: var(--primary); background: rgba(0, 212, 255, 0.03); }

        textarea.wide-editor {
            width: 100%; min-height: 200px; padding: 25px; background: #000; 
            border: 1px solid var(--border); border-radius: 20px; color: #fff;
            margin-top: 20px; font-size: 1rem; line-height: 1.6; outline: none; transition: 0.3s;
        }
        textarea.wide-editor:focus { border-color: var(--primary); box-shadow: 0 0 20px rgba(0, 212, 255, 0.1); }

        /* ACTION BUTTONS */
        .action-group { display: grid; grid-template-columns: 2fr 1fr; gap: 15px; margin-top: 20px; }
        .btn-main { padding: 20px; border-radius: 16px; border: none; font-weight: 800; cursor: pointer; font-size: 1rem; transition: 0.3s; }
        .btn-launch { background: linear-gradient(90deg, var(--primary), var(--secondary)); color: #fff; }
        .btn-auto { background: #090c12; color: #00ffaa; border: 1px solid #00ffaa; }
        .btn-auto.active { background: #00ffaa; color: #000; }

        /* CONSOLE WIDE */
        .console-wide {
            background: #000; border-radius: 20px; padding: 20px;
            font-family: 'Consolas', monospace; font-size: 0.85rem;
            height: 300px; overflow-y: auto; border: 1px solid var(--border); color: #0f0;
        }

        /* HISTORY TABLE FULL */
        .table-responsive { width: 100%; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 15px; color: var(--primary); border-bottom: 2px solid var(--border); }
        td { padding: 15px; border-bottom: 1px solid var(--border); color: var(--text-dim); }

        input[type="file"] { display: none; }
    </style>
</head>
<body>

<div class="toggle-menu" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
</div>

<aside id="sidebar">
    <div style="padding: 20px 10px; margin-bottom: 20px;">
        <h2 style="font-weight: 900; color: #fff; font-size: 1.4rem;">XSANZ BOX</h2>
    </div>
    <div class="nav-menu">
        <div class="nav-link active" onclick="switchPage('dashboard', this)"><i class="fas fa-rocket"></i> Main Control</div>
        <div class="nav-link" onclick="switchPage('history', this)"><i class="fas fa-database"></i> Database History</div>
    </div>
</aside>

<main>
    <div class="container-fluid">
        <div id="dashboard" class="page active">
            <div class="card-full">
                <div class="section-title">Step 1: Content Payload</div>
                <div class="upload-wide" onclick="document.getElementById('fileInp').click()">
                    <i class="fas fa-file-upload" style="font-size: 2.5rem; color: var(--primary); margin-bottom: 15px;"></i>
                    <h3 id="fileText">Klik untuk Upload Gambar/Video Promosi</h3>
                    <p style="color: var(--text-dim); margin-top: 5px;">File akan dikirim sebagai media utama broadcast</p>
                </div>
                <input type="file" id="fileInp" accept="image/*,video/*" onchange="document.getElementById('fileText').innerText = 'READY: ' + this.files[0].name">
                
                <textarea id="caption" class="wide-editor" placeholder="Tulis caption marketing lo di sini (Support HTML)..."></textarea>
                
                <div class="action-group">
                    <button class="btn-main btn-launch" onclick="launch()"><i class="fas fa-paper-plane"></i> LUNCURKAN KE TARGET DATABASE</button>
                    <button id="autoBtn" class="btn-main btn-auto" onclick="toggleAuto()"><i class="fas fa-sync-alt"></i> MODE AUTO-PILOT (5m)</button>
                </div>
            </div>

            <div class="card-full">
                <div class="section-title">Step 2: Monitoring System</div>
                <div id="logs" class="console-wide">
                    <div>[SYSTEM] Ultra-Wide Interface Initialized...</div>
                    <div style="color: #555;">[IDLE] Awaiting command from deployer XSANZ.</div>
                </div>
            </div>
        </div>

        <div id="history" class="page">
            <div class="card-full">
                <div class="section-title">Broadcast Data Archive</div>
                <div class="table-responsive">
                    <table id="historyTable">
                        <thead>
                            <tr>
                                <th>TIMESTAMP</th>
                                <th>TARGET ID</th>
                                <th>STATUS</th>
                                <th>CONTENT TYPE</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    const TOKEN = "8343433110:AAFxN1Lb6t15KWeVcxtVZUkK0lfoxI3_YLc";
    let autoActive = false;
    let autoInterval = null;

    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('hidden');
    }

    function switchPage(pageId, element) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        element.classList.add('active');
    }

    function writeLog(msg, color = "#0f0") {
        const time = new Date().toLocaleTimeString();
        const logs = document.getElementById('logs');
        logs.innerHTML += `<div style="color: ${color}">[${time}] ${msg}</div>`;
        logs.scrollTop = logs.scrollHeight;
    }

    function addHistory(id, status, type) {
        const table = document.querySelector('#historyTable tbody');
        const row = `<tr>
            <td>${new Date().toLocaleString()}</td>
            <td>${id}</td>
            <td style="color:${status === 'OK' ? '#00ffaa' : '#ff4444'}">${status}</td>
            <td>${type}</td>
        </tr>`;
        table.insertAdjacentHTML('afterbegin', row);
    }

    async function launch() {
        const file = document.getElementById('fileInp').files[0];
        const caption = document.getElementById('caption').value;
        if(!caption) return alert("Pesan tidak boleh kosong!");

        writeLog("Mengakses database Telegram API...", "yellow");
        try {
            const res = await fetch(`https://api.telegram.org/bot${TOKEN}/getUpdates`);
            const data = await res.json();
            const ids = [...new Set(data.result.map(u => u.message?.chat.id || u.my_chat_member?.chat.id).filter(id => id))];

            if(ids.length === 0) return writeLog("CRITICAL: Target tidak ditemukan!", "red");

            writeLog(`Memulai gempuran ke ${ids.length} target...`, "cyan");
            for(const id of ids) {
                const fd = new FormData();
                fd.append('chat_id', id);
                fd.append('caption', caption);
                fd.append('parse_mode', 'HTML');
                
                let method = file ? (file.type.startsWith('image/') ? "sendPhoto" : "sendVideo") : "sendMessage";
                if(file) fd.append(file.type.startsWith('image/') ? 'photo' : 'video', file);
                else fd.append('text', caption);

                const send = await fetch(`https://api.telegram.org/bot${TOKEN}/${method}`, { method: 'POST', body: fd });
                const result = await send.json();
                
                if(result.ok) {
                    writeLog(`SUCCESS: Terkirim ke ${id}`, "#00ffaa");
                    addHistory(id, 'OK', method);
                } else {
                    writeLog(`FAILED: ${id} - ${result.description}`, "red");
                    addHistory(id, 'FAIL', method);
                }
                await new Promise(r => setTimeout(r, 800));
            }
            writeLog("BATCH SELESAI.", "#fff");
        } catch(e) { writeLog("ERROR: " + e.message, "red"); }
    }

    function toggleAuto() {
        const btn = document.getElementById('autoBtn');
        if(!autoActive) {
            autoActive = true;
            btn.classList.add('active');
            btn.innerHTML = `<i class="fas fa-pause"></i> STOP AUTO-PILOT`;
            writeLog("MODE AUTO-PILOT AKTIF (Setiap 5 Menit)", "cyan");
            launch();
            autoInterval = setInterval(launch, 300000);
        } else {
            autoActive = false;
            btn.classList.remove('active');
            btn.innerHTML = `<i class="fas fa-sync-alt"></i> MODE AUTO-PILOT (5m)`;
            clearInterval(autoInterval);
            writeLog("MODE AUTO-PILOT DINONAKTIFKAN", "red");
        }
    }
</script>

</body>
</html>
